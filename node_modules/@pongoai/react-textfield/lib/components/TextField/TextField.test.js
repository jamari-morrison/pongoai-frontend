import React from 'react';
import { TextField } from './TextField';
import { isConformant } from '../../common/isConformant';
import { render, screen, fireEvent } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { resetIdsForTests } from '@fluentui/react-utilities';
//credit to https://github.com/microsoft/fluentui for being the base of this set of tests
describe('TextField', () => {
    let renderedComponent;
    let textfieldRef = React.createRef();
    isConformant({
        Component: TextField,
        displayName: 'TextField',
        testOptions: {
            'make-styles-overrides-win': {
                callCount: 1,
            },
        },
    });
    beforeEach(() => {
        resetIdsForTests();
    });
    afterEach(() => {
        textfieldRef = React.createRef();
        if (renderedComponent) {
            renderedComponent.unmount();
            renderedComponent = undefined;
        }
    });
    it('respects id prop', () => {
        renderedComponent = render(React.createElement(TextField, { id: "testing-id", "data-testid": "textfield" }, "Default textfield"));
        expect(renderedComponent.getByTestId('textfield').id).toEqual('testing-id');
    });
    it('defaults to empty', () => {
        render(React.createElement(TextField, { input: { ref: textfieldRef } }, "Default textfield"));
        expect(textfieldRef.current?.value).toBe('');
    });
    it('respects defaultValue prop', () => {
        render(React.createElement(TextField, { input: { ref: textfieldRef }, defaultValue: "default" }, "Default textfield"));
        expect(textfieldRef.current?.value).toBe('default');
    });
    it('calls onChange with the correct value', () => {
        const eventHandler = jest.fn();
        render(React.createElement(TextField, { input: { ref: textfieldRef }, onChange: eventHandler, "data-testid": "textfield" }));
        const input = screen.getByRole('textbox');
        expect(eventHandler).toBeCalledTimes(0);
        fireEvent.change(input, { target: { value: 'changed' } });
        expect(eventHandler).toBeCalledTimes(2);
        expect(textfieldRef.current?.value).toBe('changed');
    });
    it('does not call onChange when disabled', () => {
        const eventHandler = jest.fn();
        render(React.createElement(TextField, { disabled: true, input: { ref: textfieldRef }, onChange: eventHandler, "data-testid": "textfield" }));
        const input = screen.getByRole('textbox');
        expect(eventHandler).toBeCalledTimes(0);
        userEvent.type(input, 'changed');
        expect(eventHandler).toBeCalledTimes(0);
        expect(textfieldRef.current?.value).toBe('');
    });
    it('only accepts numbers when configured to number', () => {
        const eventHandler = jest.fn();
        render(React.createElement(TextField, { number: true, input: { ref: textfieldRef }, onChange: eventHandler, "data-testid": "textfield" }));
        const input = screen.getByRole('spinbutton');
        expect(eventHandler).toBeCalledTimes(0);
        userEvent.type(input, '123abc123abc');
        expect(eventHandler).toBeCalledTimes(12);
        expect(textfieldRef.current?.value).toBe('123123');
    });
});
//# sourceMappingURL=TextField.test.js.map